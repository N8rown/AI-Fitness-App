services:
  api:
    build:
      context: ./api
      dockerfile: Dockerfile
    restart: unless-stopped
    ports: [ "3000:3000" ]
    environment:
      DATABASE_PATH: /app/fitness.db
      JWT_SECRET: your-secret-key-change-in-production
      PORT: 3000
      NODE_ENV: development
      OPENAI_API_KEY: ${OPENAI_API_KEY:-}
    volumes:
      - ./api:/app
      - /app/node_modules
      - ./api/fitness.db:/app/fitness.db

  web:
    build:
      context: ./ai-fitness-web
      dockerfile: Dockerfile
    restart: unless-stopped
    ports: [ "5173:5173" ]
    environment:
      VITE_API_URL: http://api:3000/api
    depends_on:
      - api
    volumes:
      - ./ai-fitness-web:/app
      - /app/node_modules